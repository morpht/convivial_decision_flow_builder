<div class="convivial-decision-flow" id="bar">
  <!-- Welcome Step with Form Input -->
  <div class="step" id="bar-welcome" data-cookie="outcome=bar-welcome">
    <h3 class="step__heading">Welcome to Our Bar</h3>
    <div>
      <p>To start, please tell us your nationality and age:</p>
      <form class="df-form" action="#bar-age-based">
        <label for="nationality">Your nationality:</label>
        <select name="nationality" required>
          <option value="australian">Australian</option>
          <option value="czech">Czech</option>
          <option value="japanese">Japanese</option>
        </select>
        <label for="age">Your age:</label>
        <input type="number" name="age" placeholder="Your age" required>
        <input type="submit" value="Next">
      </form>
    </div>
  </div>

  <!-- Filters and Age-based Content -->
  <div class="step" id="bar-age-based" data-cookie="outcome=bar-age-based">
    <h3>Age-based Drink Recommendations</h3>
    <div data-df-filter="!var_nationality_eq_japanese+var_age_gte_18,var_nationality_eq_japanese+var_age_gte_20">
      <p>Since you are over the legal drinking age, you might enjoy these alcoholic beverages.</p>
      <p class="step__question">What type of drink do you prefer?</p>
      <ul>
        <li><a class="step__answer" href="#bar-beer" data-answer-path="beer">Beer</a></li>
        <li data-df-filter="var_nationality_eq_australian"><a class="step__answer" href="#bar-vodka"
            data-answer-path="vodka">Vodka</a></li>
        <li data-df-filter="var_nationality_eq_czech"><a class="step__answer" href="#bar-spirits"
            data-answer-path="spirits">Spirits</a></li>
        <li data-df-filter="var_nationality_eq_japanese"><a class="step__answer" href="#bar-sake"
            data-answer-path="sake">Sake</a></li>
      </ul>
    </div>
    <div data-df-filter="!var_nationality_eq_japanese+var_age_lt_18,var_nationality_eq_japanese+var_age_lt_20">
      <p>For non-alcoholic options, try water or sodas.</p>
      <ul>
        <li><a class="step__answer" href="#bar-water" data-answer-path="water">Water</a></li>
        <li><a class="step__answer" href="#bar-soda" data-answer-path="soda">Soda</a></li>
      </ul>
    </div>
  </div>

  <!-- Drink Options -->
  <div class="step" id="bar-beer" data-cookie="outcome=bar-beer">
    <h3 class="step__heading">Beer</h3>
    <div>
      <ul>
        <li data-df-filter="var_nationality_eq_australian">Carlton Draught</li>
        <li data-df-filter="var_nationality_eq_australian">VB</li>
        <li data-df-filter="var_nationality_eq_czech">Březňák</li>
        <li data-df-filter="var_nationality_eq_czech">Starobrno</li>
        <li data-df-filter="var_nationality_eq_japanese">Asahi</li>
        <li data-df-filter="var_nationality_eq_japanese">Sapporo</li>
      </ul>
    </div>
  </div>
  <div class="step" id="bar-vodka" data-cookie="outcome=bar-vodka">
    <h3 class="step__heading">Vodka</h3>
    <div>
      <ul>
        <li>Smirnoff</li>
        <li>Belvedere</li>
      </ul>
    </div>
  </div>
  <div class="step" id="bar-sake" data-cookie="outcome=bar-sake">
    <h3 class="step__heading">Sake Selection</h3>
    <div>
      <ul>
        <li>Junmai-shu</li>
        <li>Namazake</li>
      </ul>
    </div>
  </div>
  <div class="step" id="bar-spirits" data-cookie="outcome=bar-spirits">
    <h3 class="step__heading">Spirits Selection</h3>
    <div>
      <ul>
        <li>Fernet</li>
        <li>Becherovka</li>
      </ul>
    </div>
  </div>
  <div class="step" id="bar-water" data-cookie="outcome=bar-water">
    <h3 class="step__heading">Water Selection</h3>
    <div>
      <ul>
        <li>Still Water</li>
        <li>Sparkling Water</li>
      </ul>
    </div>
  </div>
  <div class="step" id="bar-soda" data-cookie="outcome=bar-soda">
    <h3 class="step__heading">Soda Selection</h3>
    <div>
      <ul>
        <li>Pepsi</li>
        <li>Coke</li>
      </ul>
    </div>
  </div>

  <div data-df-show="history"></div>
  <div data-df-show="submission"></div>
  <div data-df-show="yearsUntil100"></div>

  <div class="convivial-decision-flow__footer">
    <button class="btn btn-secondary step__button step__button--back">Back</button>
    <button class="btn btn-secondary step__button step__button--restart">Restart</button>
  </div>
</div>

<script>
  // Define the custom function for yearsUntil100
  // See https://github.com/morpht/convivial_decision_flow?tab=readme-ov-file#define-and-execute-custom-functions
  window.df.functions.show['yearsUntil100'] = (context, el) => {
    const age = context.storageData.vars.age || 0;

    if (age > 0) {
      const yearsUntil100 = 100 - age;
      el.innerHTML = `<h4>You have ${yearsUntil100} years until you turn 100.</h4>`;
    }
  };
</script>
